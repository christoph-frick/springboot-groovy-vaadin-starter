//
// springboot plugin configs
//

// https://github.com/johndevs/gradle-vaadin-plugin/issues/372#issuecomment-293927689
configurations['vaadin-client'].resolutionStrategy {
    dependencySubstitution {
        substitute module('javax.validation:validation-api') with module('javax.validation:validation-api:1.0.0.GA')
    }
}

springBoot {
    mainClass = mainClassName
}

bootRepackage {
    mainClass = mainClassName
}

// pull in vaadin tasks several of the springboot tasks shall depend on
jar {
    from 'src/main/webapp'
    dependsOn = ["vaadinCompile", "vaadinThemeCompile"]
    manifest {
        attributes 'Main-Class': mainClassName
    }
    finalizedBy bootRepackage
}

bootRun {
    classpath += configurations['vaadin-server']
    classpath += configurations['vaadin-client']
    dependsOn = ["vaadinCompile", "vaadinThemeCompile"]
}

// pass sysprops down to bootRun, so we can add them in configs in intellij
bootRun.systemProperties = System.properties
